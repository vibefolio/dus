<% content_for :title, "관리자 - 디어스" %>

<!DOCTYPE html>
<html lang="ko">
  <head>
    <title><%= content_for(:title) || "관리자 - 디어스" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="robots" content="noindex, nofollow">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag "actiontext", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: { DEFAULT: "#00a859", dark: "#008a47" },
              accent: "#00d670",
            },
            fontFamily: {
              sans: ["Inter", "sans-serif"],
              serif: ["Noto Serif KR", "serif"],
            }
          }
        }
      }
    </script>
  </head>

  <body style="background: var(--color-gray-50);">
    <!-- Admin Header -->
    <header style="background: white; border-bottom: 1px solid var(--color-gray-200); position: sticky; top: 0; z-index: var(--z-sticky);">
      <div style="max-width: 1400px; margin: 0 auto; padding: var(--space-4) var(--space-6); display: flex; justify-content: space-between; align-items: center;">
        <div style="display: flex; align-items: center; gap: var(--space-3);">
          <%= image_tag "logo.png", alt: "디어스", style: "height: 48px;" %>
          <span style="color: var(--color-gray-500); font-weight: 800; font-size: 1.25rem;">ADMIN</span>
        </div>
        <%= link_to "사이트 보기", root_path, class: "btn btn-outline btn-sm", target: "_blank" %>
      </div>
    </header>

    <div style="display: flex; min-height: calc(100vh - 65px);">
      <!-- Sidebar -->
      <aside style="width: 250px; background: white; border-right: 1px solid var(--color-gray-200); padding: var(--space-6);">
        <nav>
          <h3 style="font-size: var(--text-sm); font-weight: 700; color: var(--color-gray-500); text-transform: uppercase; margin-bottom: var(--space-4); letter-spacing: 0.05em;">메뉴</h3>
          <ul style="list-style: none; padding: 0;">
            <li style="margin-bottom: var(--space-2);">
              <%= link_to admin_root_path, style: "display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3); border-radius: var(--radius-md); color: var(--color-gray-700); text-decoration: none; transition: all var(--transition-fast); #{current_page?(admin_root_path) ? 'background: var(--color-primary); color: white;' : ''}" do %>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="3" width="7" height="7"/>
                  <rect x="14" y="3" width="7" height="7"/>
                  <rect x="14" y="14" width="7" height="7"/>
                  <rect x="3" y="14" width="7" height="7"/>
                </svg>
                <span>대시보드</span>
              <% end %>
            </li>
            <% if session[:admin_id] == "admin" || current_user&.super_admin? %>
              <li style="margin-bottom: var(--space-2);">
                <%= link_to admin_portfolios_path, style: "display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3); border-radius: var(--radius-md); color: var(--color-gray-700); text-decoration: none; transition: all var(--transition-fast); #{current_page?(admin_portfolios_path) ? 'background: var(--color-primary); color: white;' : ''}" do %>
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2"/>
                    <circle cx="8.5" cy="8.5" r="1.5"/>
                    <path d="M21 15l-5-5L5 21"/>
                  </svg>
                  <span>포트폴리오</span>
                <% end %>
              </li>
              <li style="margin-bottom: var(--space-2);">
                <%= link_to admin_design_templates_path, style: "display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3); border-radius: var(--radius-md); color: var(--color-gray-700); text-decoration: none; transition: all var(--transition-fast); #{current_page?(admin_design_templates_path) ? 'background: var(--color-primary); color: white;' : ''}" do %>
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                  </svg>
                  <span>디자인 템플릿</span>
                <% end %>
              </li>
            <% end %>

            <li style="margin-bottom: var(--space-2);">
              <%= link_to admin_agencies_path, style: "display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3); border-radius: var(--radius-md); color: var(--color-gray-700); text-decoration: none; transition: all var(--transition-fast); #{current_page?(admin_agencies_path) ? 'background: var(--color-primary); color: white;' : ''}" do %>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                  <circle cx="9" cy="7" r="4"></circle>
                  <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                  <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
                <span>에이전시 관리</span>
              <% end %>
            </li>
            <li style="margin-bottom: var(--space-2);">
              <%= link_to admin_quotes_path, style: "display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3); border-radius: var(--radius-md); color: var(--color-gray-700); text-decoration: none; transition: all var(--transition-fast); #{current_page?(admin_quotes_path) ? 'background: var(--color-primary); color: white;' : ''}" do %>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                  <polyline points="22,6 12,13 2,6"/>
                </svg>
                <span>문의 내역</span>
              <% end %>
            </li>
            <li style="margin-bottom: var(--space-2);">
              <%= link_to admin_orders_path, style: "display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3); border-radius: var(--radius-md); color: var(--color-gray-700); text-decoration: none; transition: all var(--transition-fast); #{current_page?(admin_orders_path) ? 'background: var(--color-primary); color: white;' : ''}" do %>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="9" cy="21" r="1"></circle>
                  <circle cx="20" cy="21" r="1"></circle>
                  <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                </svg>
                <span>주문 관리</span>
              <% end %>
            </li>

            <% if session[:admin_id] == "admin" || current_user&.super_admin? %>
              <li style="margin-bottom: var(--space-2);">
                <%= link_to admin_users_path, style: "display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3); border-radius: var(--radius-md); color: var(--color-gray-700); text-decoration: none; transition: all var(--transition-fast); #{current_page?(admin_users_path) ? 'background: var(--color-primary); color: white;' : ''}" do %>
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                  </svg>
                  <span>회원 관리</span>
                <% end %>
              </li>
            <% end %>
            
            <li style="margin-top: var(--space-6); border-top: 1px solid var(--color-gray-200); padding-top: var(--space-4);">
              <%= button_to admin_session_path, method: :delete, style: "width: 100%; display: flex; align-items: center; gap: var(--space-3); padding: var(--space-3); border-radius: var(--radius-md); color: #dc2626; text-decoration: none; transition: all var(--transition-fast); background: none; border: none; cursor: pointer; text-align: left;" do %>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                  <polyline points="16 17 21 12 16 7"/>
                  <line x1="21" y1="12" x2="9" y2="12"/>
                </svg>
                <span>로그아웃</span>
              <% end %>
            </li>
          </ul>
        </nav>
      </aside>

      <!-- Main Content -->
      <main style="flex: 1; padding: var(--space-8);">
        <% if notice %>
          <div style="background: var(--color-success); color: white; padding: var(--space-4) var(--space-6); border-radius: var(--radius-lg); margin-bottom: var(--space-6); display: flex; align-items: center; gap: var(--space-3);">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
              <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
            <%= notice %>
          </div>
        <% end %>

        <%= yield %>
      </main>
    </div>
  </body>
</html>
